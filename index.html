<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Tic Tac Toe Online</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{
  background:#000;
  color:#fff;
  font-family:sans-serif;
  text-align:center;
}
input,button{
  padding:12px;
  font-size:18px;
  margin:5px;
  border-radius:6px;
}
#board{
  display:grid;
  grid-template-columns:repeat(3,100px);
  gap:8px;
  justify-content:center;
  margin-top:20px;
}
.cell{
  width:100px;
  height:100px;
  background:#111;
  font-size:48px;
  display:flex;
  align-items:center;
  justify-content:center;
  cursor:pointer;
}
.hidden{display:none;}
</style>
</head>
<body>

<h2>ðŸŽ® Online Tic Tac Toe</h2>

<div id="joinBox">
  <input id="roomInput" placeholder="5 digit room code">
  <br>
  <button onclick="joinRoom()">Join Room</button>
</div>

<h3 id="status"></h3>

<div id="board" class="hidden"></div>
<br>
<button id="restartBtn" class="hidden" onclick="restart()">Restart</button>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<script>
// ðŸ”´ APNA FIREBASE CONFIG YAHA DALO
const firebaseConfig = {
  apiKey: "API_KEY",
  authDomain: "PROJECT.firebaseapp.com",
  databaseURL: "https://PROJECT-default-rtdb.firebaseio.com",
  projectId: "PROJECT",
  storageBucket: "PROJECT.appspot.com",
  messagingSenderId: "SENDER_ID",
  appId: "APP_ID"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();

let roomId, mySymbol, gameRef;

const boardDiv = document.getElementById("board");
for(let i=0;i<9;i++){
  const d=document.createElement("div");
  d.className="cell";
  d.onclick=()=>move(i);
  boardDiv.appendChild(d);
}

function joinRoom(){
  roomId = document.getElementById("roomInput").value;
  if(roomId.length !== 5){
    alert("5 digit room code daalo");
    return;
  }

  gameRef = db.ref("rooms/"+roomId);

  gameRef.once("value", snap=>{
    let data = snap.val();
    if(!data){
      mySymbol="X";
      gameRef.set({
        board:["","","","","","","","",""],
        turn:"X",
        players:1
      });
    }else if(data.players===1){
      mySymbol="O";
      gameRef.update({players:2});
    }else{
      alert("Room full");
      return;
    }

    document.getElementById("joinBox").classList.add("hidden");
    boardDiv.classList.remove("hidden");
    listenGame();
  });
}

function listenGame(){
  gameRef.on("value", snap=>{
    const g=snap.val();
    if(!g) return;

    document.getElementById("status").innerText =
      g.turn===mySymbol ? "ðŸ‘‰ Aapki baari" : "â³ Opponent ki baari";

    g.board.forEach((v,i)=>{
      boardDiv.children[i].innerText=v;
    });

    const w = winner(g.board);
    if(w){
      document.getElementById("status").innerText =
        w==="draw" ? "ðŸ¤ Draw" : "ðŸ† Winner: "+w;
      document.getElementById("restartBtn").classList.remove("hidden");
    }
  });
}

function move(i){
  gameRef.once("value", snap=>{
    const g=snap.val();
    if(g.turn!==mySymbol) return;
    if(g.board[i]!=="" ) return;

    g.board[i]=mySymbol;
    g.turn = mySymbol==="X"?"O":"X";
    gameRef.update(g);
  });
}

function restart(){
  gameRef.update({
    board:["","","","","","","","",""],
    turn:"X"
  });
  document.getElementById("restartBtn").classList.add("hidden");
}

function winner(b){
  const w=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];
  for(let a of w){
    if(b[a[0]] && b[a[0]]===b[a[1]] && b[a[1]]===b[a[2]]) return b[a[0]];
  }
  return b.includes("")?null:"draw";
}
</script>
</body>
</html>
