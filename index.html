<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <title>@rp_gupta_07 | Elite Arena Pro</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0, viewport-fit=cover">

    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <style>
        :root {
            --primary: #00f2ff;
            --secondary: #7000ff;
            --bg: #050505;
            --card: rgba(255, 255, 255, .05);
            --win: #00ff88;
            --accent: #ff0055;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body, html {
            margin: 0; height: 100%; width: 100%;
            background: var(--bg); color: #fff;
            font-family: 'Segoe UI', Roboto, sans-serif;
            overflow: hidden; position: fixed;
        }

        .bg-glow {
            position: fixed; inset: 0;
            background: radial-gradient(circle at center, #1a1a2e 0%, #050505 100%);
            z-index: -1;
        }

        .container {
            max-width: 450px; height: 100%;
            margin: auto; display: flex; flex-direction: column;
            backdrop-filter: blur(10px);
        }

        /* UI Elements */
        .btn {
            padding: 15px; margin: 10px 0;
            border: none; border-radius: 12px;
            background: linear-gradient(135deg, var(--secondary), var(--primary));
            color: white; font-weight: bold; cursor: pointer;
            transition: 0.3s;
        }

        input {
            padding: 15px; border-radius: 12px; border: 1px solid #333;
            background: #111; color: #fff; margin-bottom: 10px;
            text-align: center; font-size: 16px;
        }

        .hidden { display: none !important; }

        /* Board Styling */
        .board {
            display: grid; grid-template-columns: repeat(3, 90px);
            gap: 10px; justify-content: center; align-content: center; flex: 1;
        }

        .cell {
            width: 90px; height: 90px; background: #111;
            border-radius: 15px; font-size: 40px; font-weight: 900;
            display: flex; align-items: center; justify-content: center;
            border: 1px solid #222; transition: 0.2s;
        }

        .cell:active { transform: scale(0.9); }
        .cell.last-move { border: 2px solid var(--primary); box-shadow: 0 0 15px var(--primary); }

        .status-bar { padding: 15px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #222; }
        .turn-indicator { color: var(--win); font-weight: bold; font-size: 14px; }

        .toast {
            position: fixed; bottom: 100px; left: 50%; transform: translateX(-50%);
            background: rgba(0,0,0,0.9); padding: 10px 20px; border-radius: 25px;
            font-size: 12px; border: 1px solid #444; opacity: 0; transition: 0.3s; z-index: 100;
        }
        .toast.show { opacity: 1; }

        #winnerOverlay {
            position: fixed; inset: 0; background: rgba(0,0,0,0.9);
            z-index: 999; display: none; flex-direction: column;
            align-items: center; justify-content: center;
        }
    </style>
</head>
<body>

<div class="bg-glow"></div>
<div id="toast" class="toast"></div>

<div id="winnerOverlay">
    <h1 id="winnerName" style="font-size: 50px; color: var(--win);">WINNER!</h1>
    <button class="btn" onclick="resetGame()" style="width: 200px;">NEXT ROUND</button>
</div>

<div class="container">
    <div id="loginScreen" style="flex:1; display:flex; flex-direction:column; justify-content:center; padding:30px;">
        <h1 style="text-align:center; letter-spacing:2px;">ELITE ARENA <span style="color:var(--primary)">PRO</span></h1>
        <p style="text-align:center; color:#888; font-size:12px;">CREATED BY @RP_GUPTA_07</p>
        <input id="userName" type="text" placeholder="ENTER YOUR NAME" maxlength="12">
        <button class="btn" onclick="startSolo()">START SOLO VS ROBOT</button>
    </div>

    <div id="gameScreen" class="hidden" style="flex:1; display:flex; flex-direction:column;">
        <div class="status-bar">
            <span id="status" class="turn-indicator">PLAYER TURN</span>
            <button onclick="location.reload()" style="background:none; border:none; color:red; cursor:pointer;">EXIT</button>
        </div>

        <div id="board" class="board"></div>

        <div style="padding: 20px; display: flex; gap: 10px; justify-content: center;">
            <button class="btn" onclick="undoMove()" style="flex:1; background:#222;">UNDO</button>
            <button class="btn" onclick="toggleTheme()" style="flex:1; background:#222;">THEME</button>
        </div>
    </div>
</div>

<script>
    // Game State
    let boardState = Array(9).fill("");
    let mySymbol = "X";
    let botSymbol = "O";
    let isGameOver = false;
    let history = [];
    let currentPlayer = "X";

    // Sounds
    const sndMove = new Audio("https://actions.google.com/sounds/v1/cartoon/wood_plank_flicks.ogg");

    function showToast(msg) {
        const t = document.getElementById("toast");
        t.innerText = msg; t.classList.add("show");
        setTimeout(() => t.classList.remove("show"), 2000);
    }

    function startSolo() {
        const name = document.getElementById("userName").value.trim();
        if(!name) return showToast("PLEASE ENTER NAME");
        document.getElementById("loginScreen").classList.add("hidden");
        document.getElementById("gameScreen").classList.remove("hidden");
        initBoard();
        showToast("WELCOME " + name.toUpperCase());
    }

    function initBoard() {
        const boardEl = document.getElementById("board");
        boardEl.innerHTML = "";
        for(let i=0; i<9; i++) {
            let cell = document.createElement("div");
            cell.className = "cell";
            cell.dataset.index = i;
            cell.onclick = () => handleMove(i);
            boardEl.appendChild(cell);
        }
    }

    function handleMove(i) {
        if(boardState[i] !== "" || isGameOver || currentPlayer !== "X") return;

        makeMove(i, "X");
        
        if(!isGameOver) {
            document.getElementById("status").innerText = "ROBOT THINKING...";
            setTimeout(botMove, 600);
        }
    }

    function makeMove(i, symbol) {
        history.push([...boardState]);
        boardState[i] = symbol;
        const cells = document.getElementsByClassName("cell");
        cells[i].innerText = symbol;
        cells[i].style.color = symbol === "X" ? "var(--primary)" : "var(--accent)";
        
        // Highlight last move
        Array.from(cells).forEach(c => c.classList.remove("last-move"));
        cells[i].classList.add("last-move");
        
        sndMove.play();
        checkWinner();
        currentPlayer = symbol === "X" ? "O" : "X";
        if(!isGameOver) {
            document.getElementById("status").innerText = currentPlayer === "X" ? "YOUR TURN" : "ROBOT TURN";
        }
    }

    function botMove() {
        if(isGameOver) return;
        
        // Smart AI: 1. Win if possible, 2. Block if needed, 3. Random
        let bestMove = findLogicMove("O") || findLogicMove("X") || findRandomMove();
        makeMove(bestMove, "O");
    }

    function findLogicMove(sym) {
        const lines = [[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];
        for(let l of lines) {
            let vals = l.map(i => boardState[i]);
            if(vals.filter(v => v === sym).length === 2 && vals.includes("")) {
                return l[vals.indexOf("")];
            }
        }
        return null;
    }

    function findRandomMove() {
        let available = boardState.map((v, i) => v === "" ? i : null).filter(v => v !== null);
        return available[Math.floor(Math.random() * available.length)];
    }

    function checkWinner() {
        const lines = [[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];
        for(let l of lines) {
            const [a, b, c] = l;
            if(boardState[a] && boardState[a] === boardState[b] && boardState[a] === boardState[c]) {
                endGame(boardState[a]);
                return;
            }
        }
        if(!boardState.includes("")) endGame("draw");
    }

    function endGame(result) {
        isGameOver = true;
        const overlay = document.getElementById("winnerOverlay");
        const winText = document.getElementById("winnerName");
        
        if(result === "draw") {
            winText.innerText = "IT'S A DRAW!";
            winText.style.color = "#888";
        } else {
            winText.innerText = result === "X" ? "YOU WIN!" : "ROBOT WINS!";
            winText.style.color = result === "X" ? "var(--win)" : "var(--accent)";
            if(result === "X") confetti();
        }
        
        setTimeout(() => { overlay.style.display = "flex"; }, 500);
    }

    function resetGame() {
        boardState = Array(9).fill("");
        isGameOver = false;
        currentPlayer = "X";
        history = [];
        document.getElementById("winnerOverlay").style.display = "none";
        document.getElementById("status").innerText = "YOUR TURN";
        initBoard();
    }

    function undoMove() {
        if(history.length < 2 || isGameOver) return showToast("CANNOT UNDO");
        // Undo user AND bot move
        history.pop(); 
        boardState = history.pop();
        currentPlayer = "X";
        
        const cells = document.getElementsByClassName("cell");
        boardState.forEach((v, i) => {
            cells[i].innerText = v;
            cells[i].classList.remove("last-move");
        });
        showToast("MOVE REVERSED");
    }

    function toggleTheme() {
        const colors = ["#00f2ff", "#ff0055", "#00ff88", "#ffff00"];
        const randomColor = colors[Math.floor(Math.random()*colors.length)];
        document.documentElement.style.setProperty('--primary', randomColor);
        showToast("THEME UPDATED");
    }
</script>
</body>
</html>

