<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <title>Ultimate Game Arena</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-database-compat.js"></script>
    <style>
        :root { --p: #00f2ff; --bg: #05050a; --c: #1a1a2e; }
        * { box-sizing: border-box; font-family: sans-serif; -webkit-tap-highlight-color: transparent; }
        body { margin: 0; background: var(--bg); color: #fff; overflow: hidden; }
        .wrapper { max-width: 450px; margin: auto; height: 100vh; display: flex; flex-direction: column; position: relative; }
        
        /* Auth */
        #login { position: absolute; inset: 0; background: var(--bg); z-index: 1000; padding: 40px 20px; display: flex; flex-direction: column; justify-content: center; }
        input { width: 100%; padding: 15px; margin-bottom: 10px; border-radius: 10px; border: 1px solid #333; background: #111; color: #fff; }
        .btn { width: 100%; padding: 15px; border: none; border-radius: 10px; background: var(--p); font-weight: bold; cursor: pointer; }

        /* Game UI */
        .top { padding: 10px; background: #111; display: flex; justify-content: space-between; font-size: 12px; border-bottom: 1px solid #222; }
        #menu { flex: 1; overflow-y: auto; display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; padding: 15px; }
        .g-item { background: var(--c); padding: 15px 5px; border-radius: 12px; text-align: center; border: 1px solid #333; cursor: pointer; }
        .g-item:active { background: var(--p); color: #000; }
        
        #stage { position: absolute; inset: 0; background: #000; z-index: 500; display: none; flex-direction: column; align-items: center; justify-content: center; }
        canvas { background: #111; border: 2px solid #333; border-radius: 10px; touch-action: none; }
        
        /* Chat */
        .chat { height: 200px; background: #0a0a15; display: flex; flex-direction: column; border-top: 1px solid #333; }
        #msgs { flex: 1; overflow-y: auto; padding: 10px; font-size: 12px; display: flex; flex-direction: column; gap: 5px; }
        .m { padding: 6px 10px; border-radius: 10px; max-width: 80%; }
        .me { align-self: flex-end; background: var(--p); color: #000; }
        .ot { align-self: flex-start; background: #222; }
        .in { display: flex; padding: 8px; gap: 5px; background: #000; }
    </style>
</head>
<body>

<div class="wrapper">
    <div id="login">
        <h2 style="text-align:center">GAME ARENA</h2>
        <input id="u" placeholder="Apna Naam">
        <input id="r" placeholder="Room ID (Dost wala same)">
        <button class="btn" onclick="init()">START ARENA</button>
    </div>

    <div class="top">
        <span>ROOM: <b id="ro">--</b></span>
        <span id="sc">Score: 0</span>
    </div>

    <div id="menu">
        <div class="g-item" onclick="go('DINO')">ü¶ñ<br>Dino</div>
        <div class="g-item" onclick="go('SNAKE')">üêç<br>Snake</div>
        <div class="g-item" onclick="go('CATCH')">üçé<br>Catch</div>
        <div class="g-item" onclick="go('FLAPPY')">üê¶<br>Flappy</div>
        <div class="g-item" onclick="go('PONG')">üèì<br>Pong</div>
        <div class="g-item" onclick="go('DODGE')">üöó<br>Dodge</div>
        <div class="g-item" onclick="go('MATH')">üî¢<br>Math</div>
        <div class="g-item" onclick="go('STACK')">üì¶<br>Stack</div>
        <div class="g-item" onclick="go('SHOOT')">üéØ<br>Shoot</div>
        <div class="g-item" onclick="go('JUMP')">üöÄ<br>Jump</div>
        <div class="g-item" onclick="go('TAP')">‚ö°<br>Fast Tap</div>
        <div class="g-item" onclick="go('AVOID')">üí£<br>Avoid</div>
        <div class="g-item" onclick="go('GLOW')">‚ú®<br>Glow</div>
        <div class="g-item" onclick="go('MINES')">üíé<br>Mines</div>
        <div class="g-item" onclick="go('TICTAC')">‚ùå<br>TicTac</div>
    </div>

    <div id="stage">
        <div style="color:red; margin-bottom:10px" onclick="stop()">‚úï CLOSE GAME</div>
        <canvas id="cvs" width="300" height="300"></canvas>
    </div>

    <div class="chat">
        <div id="msgs"></div>
        <div class="in">
            <input id="ci" placeholder="Chat..." style="margin:0; flex:1">
            <button onclick="send()" style="border:none; background:var(--p); border-radius:5px">‚û§</button>
        </div>
    </div>
</div>

<script>
    const config = { apiKey: "AIzaSyARuO_pN2vdYrVKYkKHHaNys7WI8HqM6I4", databaseURL: "https://friendchat-43941-default-rtdb.firebaseio.com" };
    firebase.initializeApp(config);
    const rtdb = firebase.database();

    let user, room, chatRef, active = false, mode = "", score = 0;
    const canvas = document.getElementById('cvs'), ctx = canvas.getContext('2d');

    function init() {
        user = document.getElementById('u').value;
        room = document.getElementById('r').value;
        if (user && room) {
            document.getElementById('login').style.display="none";
            document.getElementById('ro').innerText = room;
            chatRef = rtdb.ref("rooms/"+room+"/chat");
            chatRef.on("child_added", s => {
                const d = s.val();
                const div = document.createElement('div');
                div.className = `m ${d.u === user ? 'me' : 'ot'}`;
                div.innerHTML = `<small style="font-size:8px">${d.u}</small><br>${d.m}`;
                document.getElementById('msgs').appendChild(div);
                document.getElementById('msgs').scrollTop = 9999;
            });
        }
    }

    function send() {
        const i = document.getElementById('ci');
        if (i.value) { chatRef.push({ u: user, m: i.value }); i.value = ""; }
    }

    // GAME ENGINE
    let py = 200, pv = 0, obs = [], snk = [{x:10,y:10}], dir = {x:0,y:0}, food = {x:5,y:5};

    function go(m) {
        mode = m; active = true; score = 0; obs = []; py = 200; pv = 0;
        document.getElementById('stage').style.display="flex";
        if(m === 'SNAKE') { snk = [{x:10,y:10}]; dir = {x:1,y:0}; }
        loop();
    }

    function stop() { active = false; document.getElementById('stage').style.display="none"; }

    function loop() {
        if (!active) return;
        ctx.clearRect(0,0,300,300);
        document.getElementById('sc').innerText = "Score: " + score;

        if (mode === 'DINO') {
            pv += 0.8; py += pv; if(py > 250) { py = 250; pv = 0; }
            ctx.fillStyle = "#00f2ff"; ctx.fillRect(40, py, 20, 20);
            if(Math.random() < 0.02) obs.push({x:300});
            obs.forEach((o, i) => {
                o.x -= 5; ctx.fillStyle = "red"; ctx.fillRect(o.x, 250, 15, 20);
                if(o.x < 60 && o.x > 40 && py > 230) { alert("Game Over"); stop(); }
                if(o.x < -20) { obs.splice(i,1); score++; }
            });
        } 
        else if (mode === 'SNAKE') {
            let h = {x: snk[0].x + dir.x, y: snk[0].y + dir.y};
            if(h.x === food.x && h.y === food.y) { score++; food = {x:Math.floor(Math.random()*19),y:Math.floor(Math.random()*19)}; } else { snk.pop(); }
            if(h.x < 0 || h.x > 19 || h.y < 0 || h.y > 19) { alert("Over"); stop(); }
            snk.unshift(h);
            ctx.fillStyle = "lime"; snk.forEach(s => ctx.fillRect(s.x*15, s.y*15, 14, 14));
            ctx.fillStyle = "red"; ctx.fillRect(food.x*15, food.y*15, 14, 14);
        }
        else if (mode === 'CATCH') {
            ctx.fillStyle = "#00f2ff"; ctx.fillRect(py, 270, 60, 10);
            if(Math.random() < 0.03) obs.push({x: Math.random()*280, y:0});
            obs.forEach((o, i) => {
                o.y += 4; ctx.fillStyle = "gold"; ctx.fillRect(o.x, o.y, 10, 10);
                if(o.y > 270 && o.x > py && o.x < py+60) { obs.splice(i,1); score++; }
                if(o.y > 300) { alert("Missed!"); stop(); }
            });
        }
        else {
            ctx.fillStyle = "white"; ctx.fillText(mode + " STARTING...", 100, 150);
        }
        requestAnimationFrame(loop);
    }

    canvas.addEventListener('touchstart', (e) => {
        if(mode === 'DINO' && py === 250) pv = -12;
        if(mode === 'CATCH' || mode === 'PONG') py = e.touches[0].clientX - 50;
        if(mode === 'SNAKE') {
            let tx = e.touches[0].clientX;
            if(tx < 150) { let t = dir.x; dir.x = dir.y; dir.y = -t; } 
            else { let t = dir.x; dir.x = -dir.y; dir.y = t; }
        }
    });
</script>
</body>
</html>
