<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Room Join Test</title>

<style>
body{
  margin:0;
  background:#000;
  color:#fff;
  font-family:system-ui;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
}
#box{
  width:90%;
  max-width:400px;
  text-align:center;
}
input,button{
  width:100%;
  padding:14px;
  margin:10px 0;
  border-radius:10px;
  border:none;
  font-size:16px;
}
input{background:#111;color:#fff}
button{background:#1d9bf0;color:#fff;font-weight:bold}
#status{margin-top:15px;font-size:18px}
</style>
</head>

<body>

<div id="box">
  <h2>üîê Join Room</h2>
  <input id="room" placeholder="Room code">
  <button onclick="join()">Join</button>
  <div id="status"></div>
</div>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<script>
firebase.initializeApp({
  apiKey: "AIzaSyARuO_pN2vdYrVKYkKHHaNys7WI8HqM6I4",
  authDomain: "friendchat-43941.firebaseapp.com",
  databaseURL: "https://friendchat-43941-default-rtdb.firebaseio.com",
  projectId: "friendchat-43941"
});

const db = firebase.database();
let userId = "u" + Math.random().toString(36).slice(2);

function join(){
  const room = document.getElementById("room").value.trim();
  if(!room){ alert("Room code likho"); return; }

  const userRef = db.ref("rooms/"+room+"/users/"+userId);
  userRef.set(true);

  // remove on disconnect
  userRef.onDisconnect().remove();

  db.ref("rooms/"+room+"/users").on("value", snap=>{
    const count = snap.exists() ? Object.keys(snap.val()).length : 0;
    document.getElementById("status").innerText =
      "Connected users: " + count;
  });
}
</script>

</body>
</html>
